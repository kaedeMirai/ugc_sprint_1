## Исследование: выбор хранилища

В рамках исследования были рассмотрены ckickhouse и vertica.

### Числа скорости вставки и чтения данных в хранилищах

| Number of records | ClickHouse (READ) | ClickHouse (WRITE) | Vertica (READ)  | Vertica (WRITE)  |
|-------------------|-------------------|--------------------|-----------------|------------------|
| 100               | 0.00387422 sec    | 0.26186872 sec     | 0.00566983 sec  | 0.56224783 sec   |
| 500               | 0.00484014 sec    | 1.26924698 sec     | 0.01368364 sec  | 2.98163748 sec   |
| 1000              | 0.00680359 sec    | 2.81323091 sec     | 0.03810175 sec  | 5.89228590 sec   |
| 3000              | 0.00961932 sec    | 8.53486896 sec     | 0.04838880 sec  | 16.9707446 sec   |


### Схемы хранения и обработки данных

##### Схема хранения и обработки данных в vertica:

| id                                   | user_id     | movie_id    | viewed_frame     |
|--------------------------------------|-------------|-------------|------------------|
| UUID DEFAULT uuid_generate()         | VARCHAR     | VARCHAR     | INTEGER NOT NULL |
| NOT NULL                             | NOT NULL    | NOT NULL    | NOT NULL         |



1) Создание индексов Vertica Projection для ускорений запросов.
```
CREATE PROJECTION IF NOT EXISTS view_projection (id, user_id, movie_id, viewed_frame)
AS SELECT id, user_id, movie_id, viewed_frame
FROM view ORDER BY id, user_id, movie_id, viewed_frame
SEGMENTED BY HASH(id) ALL NODES KSAFE 0;
```

##### Схема хранения и обработки данных в clickhouse:

| id                            | user_id           | movie_id         | viewed_frame   |
|-------------------------------|-------------------|------------------|----------------|
| UUID DEFAULT generateUUIDv4() | String            | String           | UInt32         |
| NOT NULL                      | NOT NULL          | NOT NULL         | NOT NULL       |


1) Создание индексов по user_id и movie_id для ускорения запросов.
```
CREATE INDEX idx_user_movie ON view_table (user_id, movie_id) TYPE minmax GRANULARITY 1;BLE test.view FINAL;
```

### Дополнительная информация

- ClickHouse оптимизирован для выполнения быстрых и эффективных агрегирующих запросов, что является ключевым фактором при анализе данных о действиях пользователя.
- ClickHouse является проектом с открытым исходным кодом, что обеспечивает более высокую степень гибкости в настройке и поддержку
- ClickHouse известен своей способностью эффективно масштабироваться горизонтально. Это может быть преимуществом при увеличении объема данных и нагрузки в будущем


### Вывод:

ClickHouse отлично подходит для нашего проекта "Онлайн кинотеатр". Он обеспечивает высокую производительность на агрегирующих запросах, что важно для анализа действий пользователя в онлайн-кинотеатре, в стравнении с другими хранилищами данных. ClickHouse применяет эффективные методы сжатия данных, что позволяет уменьшить требования к дисковому пространству и обеспечивает высокую производительность при работе с большими объемами данных. А открытый исходный код и активное сообщество позволяют обеспечить гибкость настройки и разработки под свои требовани.